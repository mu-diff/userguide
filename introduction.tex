\mtcaddchapter[Introduction]                          % solution pour minitoc
\markboth{\uppercase{Introduction}}{\uppercase{Introduction}} 

\section*{What is \mudiff?}

\mudiff is a toolbox for solving two dimensional acoustic multiple scattering problem by disks using boundary integral equations. The toolbox is a set of Matlab functions that compute easily and in a fast way the classical integral operators with in addition pre and post-processing facilities. When the boundary integral formulation has been written mathematically, the translation to the computer side is easily done in \mudiff (it can be clearly implemented in less than a day). Solving the linear system is done thanks to Matlab's rich framework. No particular computation skills are needed, except knowing the Matlab's language.

Mathematically, the boundary integral operators are discretized in the Fourier basis, thanks to the circular shape of the obstacles. This leads to an accurate solution and a small size system, compared to \eg Boundary Element Method (BEM). For high frequency and/or large number of scatterers, an adapted algorithm is moreover proposed, that takes advantage of the the particular structure of the matrix (Toeplitz).

\section*{What is not \mudiff?}

Even if \mudiff is designed to solve multiple scattering problem, it is not a black box that solves a particular problem. By that, we mean that \mudiff will not not chose the integral equation formulation to be used to solve a particular problem: this theoretical aspect is let to the user. However, for non-specialist of boundary integral equation, this user guide provides a quick survey on boundary integral equations, in chapter \ref{chap:math}, and some examples of efficient integral equations in classical cases (Dirichlet/Neumann boundary condition, penetrable scatterers). This should help non specialist of boundary integral equation to use \mudiff for their work.

\section*{How to use \mudiff?}

It is hard to describe how to use \mudiff without talking about integral equation and hence, an example answers the question better as thousand words. Assume that there is a (circular) sound-soft scatterer $\Omegam$ in the medium which is  illuminated by an incident plane wave. The mathematical problem to compute the scattered field is to solve the Helmholtz equation in the propagation domain
$$
\begin{cases}
(\Delta+k^2)u = 0 & \text{ in }\Rb^2\setminus\overline{\Omegam}\\
u = -\uinc&\text{ on }\partial\Omegam\\
\text{Radiation condition at infinity}
\end{cases}
$$
A possible integral representation of the scattered field $u$ can be the following
$$
u(\xx) = \int_{\partial\Omegam} G(\xx,\yy)\rho(\yy)\dd\yy, \qquad \forall \xx\in\Rb\setminus\overline{\Omegam},
$$
where $G$ is the Green function and $\rho$ is the density, solution of a boundary integral equation, which can be the EFIE (see \ref{chap:math}):
$$
L\rho = -\uinc, \qquad \text{with } L\rho(\xx) = \int_{\partial\Omegam} G(\xx,\yy)\rho(\yy)\dd\yy, \quad \forall \xx\in\partial\Omegam.
$$
The problem is hence reduced to this boundary integral equation only: knowing $\rho$ leads to the knowledge of $u$ on every point $\xx$ of the propagation domain. Note that, in addition, its far field of $u$ can be computed easily thanks to its integral representation. The theoretical part of the problem ends here and the computational part is handled now by \mudiff by following these steps:
\begin{enumerate}
\item Pre-processing: 
\begin{enumerate}
\item Creating the obstacles
\item Building the right hand side ($-\uinc$)
\end{enumerate}
\item Assembling the matrix of the integral operator(s)
\item Solving the linear system
\item Post-processing: computing the far-field, near-field (on a point or a grid), \ldots
\end{enumerate}

Everything is done using \mudiff function except for the solving part which is done thanks to Matlab's rich framework: direct solver (backslash operator ``\textbackslash'') or iterative solver (GMRES, \ldots). This is summarized as a diagram on figure \ref{fig:howto}.

\begin{figure}
\begin{tikzpicture}
  [node distance=.8cm,
  start chain=going below,]
     \node[punktchain] (math) {Mathematical problem};
     \node[punktchain, below=of math] (choice)      {Reformule the problem as an integral formulation};
      \node[punktchain, below left=of choice] (inteq)      {Integral equation};
	 \node[punktchain, below right=of choice] (intrep)      {Integral representation};
      \node[punktchain, below =of inteq] (inteq2)      {\textbf{Pre processing}: geometry and right hand side $b$};
      \node[punktchain, below =of inteq2] (inteq3)      {\textbf{Assembling} the matrix $A$};
      \node[punktchain, below =of inteq3] (inteq4)      {Solving the linear system};
      \node[punktchain, below right = of inteq4] (postpro)      {\textbf{Post processing}:
      \begin{itemize}
      \item Far field
      \item Near field
      \item Other: incident field, displaying geometry, \ldots
      \end{itemize}
      };
%      \node[right = of postpro] (EmptyNodeR)      {};
%      \node[punktchain, below left = of postpro] (farfield)      {Far field};
  %    \node[punktchain, below = of postpro] (nearfield)      {Near field};
    %  \node[punktchain, below right = of postpro] (misc)      {Other: incident field, displaying geometry, \ldots};
      
      \draw[->] (math) to (choice);
      \draw[->] (choice) to (inteq);
      \draw[->] (choice) to (intrep);
      \draw[->] (inteq) to (inteq2);
      \draw[->] (inteq2) to (inteq3);
      \draw[->] (inteq3) to (inteq4);
      \draw[->] (inteq4) to (postpro);
      \draw[->] (intrep) to (postpro);
    %  \draw[->] (postpro) to (farfield);
  %    \draw[->] (postpro) to (nearfield);
%      \draw[->] (postpro) to (misc);
 \end{tikzpicture}
 \caption{Diagram on ``How to use \mudiff''.}
 \label{fig:howto}
 \end{figure}
  
\section*{To whom \mudiff is designed to?}

To every scientists or people in need of a fast and efficient way to either solve the acoustic multiple scattering problem by disks or to compute boundary integral operators. Indeed, the \mudiff toolbox can be used:
\begin{itemize}
\item As a solver of the multiple scattering problem%: \mudiff can be handled easily to get an accurate solution of the problem
\item As a framework for more theoretical studies on boundary integral equations%: the accurate representation of the integral operators can lead to study their spectral properties of the operators, or develop a new preconditioners, \ldots
\end{itemize}

Note that, to help non specialist on boundary integral equations, this user guide contains a chapter entirely dedicated to it, containing in particular some classical and still quite efficient boundary integral equation in different case (see chapter \ref{chap:math}).

\section*{What does this user guide contain?}

The first chapter recalls some well-known properties of the boundary integral equations. Even if this part is clearly theoretical, some practical boundary integral equations are also provided for the impenetrable case and some examples of robust integral equation are also given for the penetrable case. Moreover, some examples of usage are provided with the \mudiff toolbox. The chapter \ref{chap:fourier} explains the theory on which the \mudiff toolbox is based. More precisely, the boundary integral operators are here projected on the Fourier bases. Their associated matrix are derived, in addition to other practical quantities, such as the far field or the near field of the scattered wave. Then, the \mudiff toolbox is detailed on chapter  \ref{chap:code}: each function is detailed, with its options and with examples. Note that a list of every functions is given in the appendix, in the alphabetic order \ref{app:funFromName}, and arranged by folder location in appendix \ref{app:funFromFolder}.

